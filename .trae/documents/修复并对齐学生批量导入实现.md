## 目标
- 对齐“学生批量导入”后端实现与实际使用模板与数据库数据，消除导入失败与不一致。
- 提升健壮性（角色/部门动态解析、事务与错误收集、字段解析一致）。

## 对齐模板与字段
1. 明确学生专用模板列：专业名称、班级名称、姓名、学号、手机、性别、身份、邮箱、政治面貌、入学日期。
2. 增加可选 `deptId` 与 `loginName` 支持：若提供则优先使用；未提供时回退到“专业+班级匹配”和以学号作为登录名。
3. 模板导出统一：控制器的模板下载保持与 VO 字段一一对应；为系统用户导入模板单独保留说明，避免混淆。

## 部门与角色处理
1. 部门匹配：先用 `deptId`，没有再按“专业→班级”名称匹配；名称匹配改为严格大小写与别名表支持，避免模糊误判。
2. 角色映射：改为按 `role_key` 查询 `sys_role` 获取 ID（如 `student`、`monitor`、`counselor`），去除硬编码 ID。
3. 数据库基线：补齐班级部门初始化（若继续采用固定 `5xx` 方案）；或改文档为当前部门树结构并提供示例。

## 事务与错误处理
1. 改为“逐条处理、逐条报告”，不对全批次回滚；统计成功/失败并返回详细错误列表。
2. 对会话性错误（比如配置缺失）保留整体失败；对数据行错误仅记录该行失败。

## 数据解析统一
1. 年级推断统一：统一按学号格式解析年级（约定 4 位年份前缀），并在模板注释明确。
2. 性别/状态健壮性：同时支持 `0/1/2` 数字与“男/女/未知”中文枚举；未填采用默认。
3. 身份解析：严格限定“学生/班委/辅导员”并支持中英文别名。

## 测试与验证
1. 单元测试：导入正常、更新模式、部门不存在、角色缺失、性别/状态多格式、部分失败不回滚。
2. 集成测试：用 `ry-vue.sql` 基线与两套模板分别验证；记录性能数据（50/200/500 条）。

## 前端与文档
1. 前端：在学生导入页面展示模板说明与必填/可选字段、更新模式开关、进度与结果详情。
2. 文档：区分“系统用户导入”和“学生批量导入”两套模板与流程；更新对照表与示例。