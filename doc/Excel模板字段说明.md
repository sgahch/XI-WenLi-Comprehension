# Excel批量导入模板字段说明

## 模板下载

**下载路径**：系统管理 → 用户管理 → 导入 → 下载模板

**模板文件名**：`user_template_yyyyMMddHHmmss.xlsx`

---

## 模板字段详解

### 1. 部门编号（必填）

**字段名**：`部门编号`  
**数据类型**：数字  
**是否必填**：✅ 是  

**说明**：
- 学生：填写班级ID（500-999）
- 教职工：填写学院/专业ID（100-499）

**部门ID对照表**：

#### 学院级别（100-199）
- 100：西安文理学院（根节点）
- 101：信息工程学院
- 102：机械与材料工程学院

#### 专业级别（200-499）
- 103：软件工程专业（信息工程学院）
- 104：计算机科学与技术专业（信息工程学院）
- 210：机械工程专业（机械与材料工程学院）

#### 班级级别（500-999）

**软件工程专业**：
- 500：软工2401班
- 501：软工2402班
- 502：软工2301班
- 503：软工2302班

**计算机科学与技术专业**：
- 510：计科2401班
- 511：计科2402班
- 512：计科2301班

**机械工程专业**：
- 530：机械2401班
- 531：机械2402班

**示例**：
```
学生张三属于软工2401班 → 填写：500
辅导员王老师管理信息工程学院 → 填写：101
```

---

### 2. 登录名称（必填）

**字段名**：`登录名称`  
**数据类型**：文本  
**是否必填**：✅ 是  

**说明**：
- 学生：填写学号（如2507240101）
- 教职工：填写工号（如T20240001）
- 管理员：自定义用户名

**格式要求**：
- 必须唯一，不能重复
- 长度：2-30个字符
- 学号建议格式：10位数字（年份2位+专业2位+班级2位+序号4位）
- 工号建议格式：字母开头+数字（如T20240001、F20240001）

**示例**：
```
学生学号：2507240101（25年入学，软件工程07专业，24班，01号）
辅导员工号：T20240001（T代表Teacher，2024年入职，001号）
班委工号：M20240001（M代表Monitor，2024年任职，001号）
```

---

### 3. 用户名称（必填）

**字段名**：`用户名称`  
**数据类型**：文本  
**是否必填**：✅ 是  

**说明**：学生或教职工的真实姓名

**格式要求**：
- 长度：2-30个字符
- 支持中文、英文

**示例**：
```
张三
李四
王老师
```

---

### 4. 用户邮箱（选填）

**字段名**：`用户邮箱`  
**数据类型**：文本  
**是否必填**：❌ 否  

**说明**：用户的电子邮箱地址

**格式要求**：
- 必须符合邮箱格式（xxx@xxx.xxx）
- 长度：5-50个字符

**示例**：
```
zhangsan@example.com
wanglaoshi@xawl.edu.cn
```

---

### 5. 手机号码（选填）

**字段名**：`手机号码`  
**数据类型**：文本（注意：必须设置为文本格式，避免Excel自动转换）  
**是否必填**：❌ 否  

**说明**：用户的手机号码

**格式要求**：
- 11位数字
- 以1开头

**Excel设置技巧**：
1. 选中手机号码列
2. 右键 → 设置单元格格式
3. 选择"文本"格式
4. 输入手机号（避免科学计数法显示）

**示例**：
```
13800138000
13900139000
```

---

### 6. 用户性别（选填）

**字段名**：`用户性别`  
**数据类型**：数字  
**是否必填**：❌ 否  

**说明**：用户的性别

**可选值**：
- `0`：男
- `1`：女
- `2`：未知

**默认值**：如果不填，系统默认为"未知"

**示例**：
```
0  （男）
1  （女）
```

---

### 7. 账号状态（选填）

**字段名**：`账号状态`  
**数据类型**：数字  
**是否必填**：❌ 否  

**说明**：账号的启用/停用状态

**可选值**：
- `0`：正常（启用）
- `1`：停用

**默认值**：如果不填，系统默认为"正常"

**示例**：
```
0  （正常）
1  （停用）
```

---

## 完整示例

### 学生导入示例

| 部门编号 | 登录名称    | 用户名称 | 用户邮箱              | 手机号码    | 用户性别 | 账号状态 |
|---------|------------|---------|----------------------|------------|---------|---------|
| 500     | 2507240101 | 张三     | zhangsan@example.com | 13800138001 | 0       | 0       |
| 500     | 2507240102 | 李四     | lisi@example.com     | 13800138002 | 1       | 0       |
| 501     | 2507240201 | 王五     | wangwu@example.com   | 13800138003 | 0       | 0       |
| 510     | 2507240301 | 赵六     | zhaoliu@example.com  | 13800138004 | 0       | 0       |

**说明**：
- 张三、李四属于软工2401班（部门ID=500）
- 王五属于软工2402班（部门ID=501）
- 赵六属于计科2401班（部门ID=510）
- 导入后会自动创建学生档案，并分配学生角色

---

### 教职工导入示例

| 部门编号 | 登录名称   | 用户名称 | 用户邮箱                  | 手机号码    | 用户性别 | 账号状态 |
|---------|-----------|---------|--------------------------|------------|---------|---------|
| 101     | T20240001 | 王老师   | wanglaoshi@example.com   | 13900139001 | 0       | 0       |
| 101     | T20240002 | 李老师   | lilaoshi@example.com     | 13900139002 | 1       | 0       |
| 102     | T20240003 | 赵老师   | zhaolaoshi@example.com   | 13900139003 | 0       | 0       |

**说明**：
- 王老师、李老师属于信息工程学院（部门ID=101）
- 赵老师属于机械与材料工程学院（部门ID=102）
- 导入后会分配辅导员角色，不会创建学生档案

---

## 导入注意事项

### ✅ 导入前检查

1. **检查部门编号是否存在**
   - 在"系统管理 → 部门管理"中查看所有部门ID
   - 确保填写的部门编号在系统中已存在

2. **检查登录名称是否唯一**
   - 学号/工号不能重复
   - 如果已存在，可选择"更新已存在数据"

3. **检查数据格式**
   - 手机号码必须设置为文本格式
   - 性别、状态必须填写数字（0、1、2）

4. **检查必填字段**
   - 部门编号、登录名称、用户名称必须填写
   - 其他字段可选填

### ⚠️ 常见错误

| 错误提示 | 原因 | 解决方法 |
|---------|------|---------|
| "部门编号不存在" | 填写的部门ID在系统中不存在 | 检查部门ID是否正确，或先创建部门 |
| "登录名称已存在" | 学号/工号重复 | 修改为唯一的学号/工号，或勾选"更新已存在数据" |
| "手机号码格式错误" | 手机号不是11位数字 | 检查手机号格式，确保为11位数字 |
| "用户名称不能为空" | 用户名称未填写 | 填写用户的真实姓名 |

### 🔐 安全提示

- 所有批量导入的用户初始密码为：`123456`
- 建议用户首次登录后立即修改密码
- 管理员可在"系统管理 → 用户管理"中重置用户密码

---

## 自动化功能

### 学生导入自动操作

导入学生时，系统会自动执行以下操作：

1. ✅ 创建用户账号（sys_user表）
2. ✅ 分配学生角色（角色ID=100）
3. ✅ 自动创建学生档案（t_user_profile表）
4. ✅ 从部门树解析并填充：
   - 学院名称（如"信息工程学院"）
   - 专业名称（如"软件工程"）
   - 班级名称（如"软工2401班"）
5. ✅ 从学号推断年级（如2507240101 → 2025级）
6. ✅ 设置初始密码为：`123456`

### 教职工导入自动操作

导入教职工时，系统会自动执行以下操作：

1. ✅ 创建用户账号（sys_user表）
2. ✅ 分配辅导员角色（角色ID=102）
3. ✅ 设置初始密码为：`123456`

**注意**：教职工不会自动创建学生档案

---

## 技术支持

如有疑问，请联系系统管理员或查看：
- 《批量导入用户指南.md》
- 系统日志：系统监控 → 日志管理 → 操作日志

---

**文档版本**：v2.0.0  
**更新日期**：2025-11-09  
**适用系统**：学生综合测评系统（基于RuoYi-Vue）

