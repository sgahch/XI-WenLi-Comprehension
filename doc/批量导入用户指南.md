# 批量导入用户指南

## 概述

本系统支持通过Excel批量导入学生和教职工账户，导入时会自动创建用户账号，并为学生自动创建学生档案。

---

## 一、学生批量导入

### 1.1 模板说明

**模板名称**：`学生批量导入模板.xlsx`

**下载方式**：
- 登录系统后，进入"系统管理 → 用户管理"
- 点击"导入"按钮
- 在弹出的对话框中点击"下载模板"

### 1.2 模板字段说明

| 列名 | 字段说明 | 是否必填 | 格式要求 | 示例 |
|------|---------|---------|---------|------|
| 部门编号 | 学生所属班级的部门ID | 是 | 数字 | 500 |
| 登录名称 | 学号（作为登录用户名） | 是 | 10位数字 | 2507240101 |
| 用户名称 | 学生姓名 | 是 | 文本 | 张三 |
| 用户邮箱 | 学生邮箱 | 否 | 邮箱格式 | zhangsan@example.com |
| 手机号码 | 学生手机号 | 否 | 11位数字 | 13800138000 |
| 用户性别 | 性别 | 否 | 0=男, 1=女, 2=未知 | 0 |
| 账号状态 | 账号状态 | 否 | 0=正常, 1=停用 | 0 |

### 1.3 部门编号对照表

**三级部门结构**：学院 → 专业 → 班级

#### 信息工程学院（101）

**软件工程专业（103）**
- 软工2401班：500
- 软工2402班：501
- 软工2301班：502
- 软工2302班：503

**计算机科学与技术专业（104）**
- 计科2401班：510
- 计科2402班：511
- 计科2301班：512

#### 机械与材料工程学院（102）

**机械工程专业（210）**
- 机械2401班：530
- 机械2402班：531

### 1.4 导入示例

```
部门编号 | 登录名称    | 用户名称 | 用户邮箱              | 手机号码    | 用户性别 | 账号状态
---------|------------|---------|----------------------|------------|---------|--------
500      | 2507240101 | 张三     | zhangsan@example.com | 13800138001 | 0       | 0
500      | 2507240102 | 李四     | lisi@example.com     | 13800138002 | 1       | 0
501      | 2507240201 | 王五     | wangwu@example.com   | 13800138003 | 0       | 0
```

### 1.5 导入后自动操作

系统会自动执行以下操作：

1. ✅ 创建用户账号（sys_user表）
2. ✅ 分配学生角色（角色ID=100）
3. ✅ 自动创建学生档案（t_user_profile表）
4. ✅ 自动填充学院、专业、班级信息（从部门树解析）
5. ✅ 自动推断年级（从学号前4位，如2507→2025级）
6. ✅ 设置初始密码为：`123456`

### 1.6 注意事项

⚠️ **重要提示**：
- 学号必须唯一，不能重复
- 部门编号必须是班级ID（500-999），不能是学院或专业ID
- 导入前请确保部门编号在系统中已存在
- 初始密码为 `123456`，学生首次登录后应修改密码
- 如果学号已存在，可选择"是否更新已存在数据"

---

## 二、教职工批量导入

### 2.1 模板说明

**模板名称**：`教职工批量导入模板.xlsx`

**下载方式**：与学生导入模板相同

### 2.2 模板字段说明

| 列名 | 字段说明 | 是否必填 | 格式要求 | 示例 |
|------|---------|---------|---------|------|
| 部门编号 | 教职工所属部门ID | 是 | 数字 | 101 |
| 登录名称 | 工号（作为登录用户名） | 是 | 文本 | T20240001 |
| 用户名称 | 教职工姓名 | 是 | 文本 | 王老师 |
| 用户邮箱 | 教职工邮箱 | 否 | 邮箱格式 | wanglaoshi@example.com |
| 手机号码 | 教职工手机号 | 否 | 11位数字 | 13900139000 |
| 用户性别 | 性别 | 否 | 0=男, 1=女, 2=未知 | 0 |
| 账号状态 | 账号状态 | 否 | 0=正常, 1=停用 | 0 |

### 2.3 部门编号对照表

**辅导员通常归属于学院或专业**：

- 信息工程学院：101
- 机械与材料工程学院：102
- 软件工程专业：103
- 计算机科学与技术专业：104
- 机械工程专业：210

### 2.4 导入示例

```
部门编号 | 登录名称   | 用户名称 | 用户邮箱                  | 手机号码    | 用户性别 | 账号状态
---------|-----------|---------|--------------------------|------------|---------|--------
101      | T20240001 | 王老师   | wanglaoshi@example.com   | 13900139001 | 0       | 0
101      | T20240002 | 李老师   | lilaoshi@example.com     | 13900139002 | 1       | 0
102      | T20240003 | 赵老师   | zhaolaoshi@example.com   | 13900139003 | 0       | 0
```

### 2.5 导入后操作

系统会自动执行以下操作：

1. ✅ 创建用户账号（sys_user表）
2. ✅ 分配辅导员角色（角色ID=102）
3. ✅ 设置初始密码为：`123456`

**注意**：教职工不会自动创建学生档案（t_user_profile表）

### 2.6 注意事项

⚠️ **重要提示**：
- 工号必须唯一，不能重复
- 工号建议以字母开头（如T、F等），便于与学号区分
- 部门编号通常为学院或专业ID（100-499）
- 初始密码为 `123456`，教职工首次登录后应修改密码

---

## 三、导入操作步骤

### 3.1 准备Excel文件

1. 下载对应的导入模板
2. 按照模板格式填写数据
3. 保存为 `.xlsx` 或 `.xls` 格式

### 3.2 执行导入

1. 登录系统
2. 进入"系统管理 → 用户管理"
3. 点击"导入"按钮
4. 选择准备好的Excel文件
5. 选择是否"更新已存在数据"
   - ✅ 勾选：如果用户名已存在，则更新用户信息
   - ❌ 不勾选：如果用户名已存在，则跳过该条记录
6. 点击"确定"开始导入
7. 查看导入结果

### 3.3 导入结果说明

导入完成后，系统会显示：
- ✅ 成功导入的记录数
- ⚠️ 跳过的记录数（用户名已存在且未勾选更新）
- ❌ 失败的记录数及失败原因

---

## 四、常见问题

### Q1: 导入失败，提示"部门编号不存在"？
**A**: 请检查Excel中的部门编号是否正确，可在"系统管理 → 部门管理"中查看所有部门ID。

### Q2: 学生导入成功，但没有创建学生档案？
**A**: 请检查：
1. 导入的用户是否分配了学生角色（角色ID=100）
2. 部门编号是否为班级ID（500-999）
3. 查看系统日志，确认是否有错误信息

### Q3: 如何批量修改已导入用户的信息？
**A**: 重新准备Excel文件，勾选"更新已存在数据"，再次导入即可。

### Q4: 初始密码是什么？
**A**: 所有批量导入的用户初始密码均为 `123456`，建议用户首次登录后立即修改。

### Q5: 如何区分学生和教职工？
**A**: 
- 学生：登录名称为学号（纯数字，如2507240101），分配学生角色
- 教职工：登录名称为工号（建议字母开头，如T20240001），分配辅导员或其他角色

---

## 五、技术支持

如遇到问题，请联系系统管理员或查看系统日志：
- 日志位置：`系统监控 → 日志管理 → 操作日志`
- 搜索关键字：`用户管理` / `导入`

---

**文档版本**：v2.0.0  
**更新日期**：2025-11-09  
**适用系统**：学生综合测评系统（基于RuoYi-Vue）

